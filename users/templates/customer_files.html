{% extends "base.html" %}
{% load static %}

{% block title %}My Files - MAKAN{% endblock %}

{% block content %}
<style>
  .file-card {
    transition: all 0.3s ease;
    border-radius: 16px;
    overflow: hidden;
  }

  .file-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }

  .file-card img {
    height: 200px;
    width: 100%;
    object-fit: cover; /* ✅ يخلي الصورة تتعبى الكارد بدون تمدد */
    object-position: center;
    border-bottom: 1px solid #eee;
  }

  .file-card .card-body {
    padding: 1rem;
  }

  .file-card h6 {
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
  }

  .file-card .btn {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
  }
</style>
<div class="container py-5">

  <h2 class="fw-bold text-primary mb-4 text-center">📁 My Files</h2>

  {% if image_files or pdf_files or cad_files or other_files %}
  
  <!-- Tabs -->
  <ul class="nav nav-pills mb-4 justify-content-center" id="fileTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="images-tab" data-bs-toggle="pill" data-bs-target="#images" type="button">🖼️ Images</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="pdfs-tab" data-bs-toggle="pill" data-bs-target="#pdfs" type="button">📄 PDFs</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="cad-tab" data-bs-toggle="pill" data-bs-target="#cad" type="button">📐 CAD Files</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="other-tab" data-bs-toggle="pill" data-bs-target="#other" type="button">📦 Others</button>
    </li>
  </ul>

  <!-- Tab Content -->
  <div class="tab-content" id="fileTabsContent">

    <!-- Images -->
    <div class="tab-pane fade show active" id="images" role="tabpanel">
      {% include "partials/files_section.html" with files=image_files color="primary" %}
    </div>

    <!-- PDFs -->
    <div class="tab-pane fade" id="pdfs" role="tabpanel">
      {% include "partials/files_section.html" with files=pdf_files color="danger" %}
    </div>

    <!-- CAD -->
    <div class="tab-pane fade" id="cad" role="tabpanel">
      {% include "partials/files_section.html" with files=cad_files color="success" %}
    </div>

    <!-- Others -->
    <div class="tab-pane fade" id="other" role="tabpanel">
      {% include "partials/files_section.html" with files=other_files color="secondary" %}
    </div>

  </div>

  {% else %}
    <div class="text-center text-muted py-5">
      <h5>No files found</h5>
      <p>Start by uploading or receiving files from your engineer.</p>
    </div>
  {% endif %}
</div>

<script>
function copyLink(fileUrl) {
  const fullUrl = window.location.origin + '/media/' + fileUrl;
  navigator.clipboard.writeText(fullUrl);
  alert('✅ File link copied!');
}
</script>
{% endblock %}
