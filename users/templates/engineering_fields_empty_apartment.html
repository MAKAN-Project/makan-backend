{% extends "base.html" %}
{% load static %}
<link rel="stylesheet" href="{% static 'style/style.css' %}">

{% block title %}Engineering Fields - Build from Scratch{% endblock %}

{% block content %}
<div class="container py-5">
<h2 class="mb-4">Engineering Fields for Empty Apartment</h2>


{% comment %} ===== Architecture Carousel ===== {% endcomment %}
    <div class="card h-100 shadow-sm specialization-carousel" data-specialization="architecture">
      <div class="card-body">
        <h5 class="card-title mb-3">Architecture</h5>
        <div class="position-relative">
          <button class="btn btn-outline-secondary btn-sm position-absolute top-50 start-0 translate-middle-y" type="button" onclick="scrollEngineers('architecture-carousel', -1)">&lt;</button>
          <div id="architecture-carousel" class="d-flex flex-row flex-nowrap overflow-auto gap-3 px-5">
            {% for engineer in architecture_engineers %}
            <a href="{% url 'engineer_details' engineer.eng_id %}" class="text-decoration-none text-dark">
              <div class="card engineer-card">
                <img
                  src="{% if engineer.profile_photo %}{{ engineer.profile_photo.url }}{% else %}/static/images/default-engineer.png{% endif %}"
                  class="card-img-top" alt="Engineer Photo" style="height:120px;object-fit:cover;">
                <div class="card-body text-center">
                  <h6 class="card-title mb-1">{{ engineer.user.first_name }} {{ engineer.user.last_name }}</h6>
                  <p class="card-text small text-muted">{{ engineer.user.email }}</p>
                </div>
              </div>
            </a>
            {% empty %}
            <div class="text-muted">No architecture engineers available.</div>
            {% endfor %}
          </div>
          <script>document.getElementById('architecture-carousel').dataset.startIdx = 0;</script>
          <button class="slider-btn position-absolute top-50 end-0 translate-middle-y" type="button" onclick="scrollEngineers('architecture-carousel', 1)">&gt;</button>
        </div>
      </div>
    </div>


    {% comment %} ===== Mechanical Engineering Carousel ===== {% endcomment %}
    <div class="card h-100 shadow-sm specialization-carousel" data-specialization="mechanical">
      <div class="card-body">
        <h5 class="card-title mb-3">Mechanical Engineering</h5>
        <div class="position-relative">
          <button class="btn btn-outline-secondary btn-sm position-absolute top-50 start-0 translate-middle-y" type="button" onclick="scrollEngineers('mechanical-carousel', -1)">&lt;</button>
          <div id="mechanical-carousel" class="d-flex flex-row flex-nowrap overflow-auto gap-3 px-5">
            {% for engineer in mechanical_engineers %}
           <a href="{% url 'engineer_details' engineer.eng_id %}" class="text-decoration-none text-dark">
              <div class="card engineer-card">
                <img
                  src="{% if engineer.profile_photo %}{{ engineer.profile_photo.url }}{% else %}/static/images/default-engineer.png{% endif %}"
                  class="card-img-top" alt="Engineer Photo" style="height:120px;object-fit:cover;">
                <div class="card-body text-center">
                  <h6 class="card-title mb-1">{{ engineer.user.first_name }} {{ engineer.user.last_name }}</h6>
                  <p class="card-text small text-muted">{{ engineer.user.email }}</p>
                </div>
              </div>
            </a>
            {% empty %}
            <div class="text-muted">No mechanical engineers available.</div>
            {% endfor %}
          </div>
          <script>document.getElementById('mechanical-carousel').dataset.startIdx = 0;</script>
          <button class="slider-btn position-absolute top-50 end-0 translate-middle-y" type="button" onclick="scrollEngineers('mechanical-carousel', 1)">&gt;</button>
        </div>
      </div>
    </div>

     {% comment %} ===== Interior Design Carousel ===== {% endcomment %}
    <div class="card h-100 shadow-sm specialization-carousel" data-specialization="interior">
      <div class="card-body">
        <h5 class="card-title mb-3">Interior Design</h5>
        <div class="position-relative">
          <button class="btn btn-outline-secondary btn-sm position-absolute top-50 start-0 translate-middle-y" type="button" onclick="scrollEngineers('interior-carousel', -1)">&lt;</button>
          <div id="interior-carousel" class="d-flex flex-row flex-nowrap overflow-auto gap-3 px-5">
            {% for engineer in interior_engineers %}
            <a href="{% url 'engineer_details' engineer.eng_id %}" class="text-decoration-none text-dark">
              <div class="card engineer-card">
                <img
                  src="{% if engineer.profile_photo %}{{ engineer.profile_photo.url }}{% else %}/static/images/default-engineer.png{% endif %}"
                  class="card-img-top" alt="Engineer Photo" style="height:120px;object-fit:cover;">
                <div class="card-body text-center">
                  <h6 class="card-title mb-1">{{ engineer.user.first_name }} {{ engineer.user.last_name }}</h6>
                  <p class="card-text small text-muted">{{ engineer.user.email }}</p>
                </div>
              </div>
            </a>
            {% empty %}
            <div class="text-muted">No interior design engineers available.</div>
            {% endfor %}
          </div>
          <script>document.getElementById('interior-carousel').dataset.startIdx = 0;</script>
          <button class="slider-btn position-absolute top-50 end-0 translate-middle-y" type="button" onclick="scrollEngineers('interior-carousel', 1)">&gt;</button>
        </div>
      </div>
    </div>

  </div>
</div>

    
<script>
  // Filter function
  function filterBySpecialization() {
    const selected = document.getElementById('specializationSelect').value;
    const carousels = document.querySelectorAll('.specialization-carousel');
    carousels.forEach(carousel => {
      if (selected === 'all' || carousel.dataset.specialization === selected) {
        carousel.style.display = 'block';
      } else {
        carousel.style.display = 'none';
      }
    });
  }

  // Initialize sliders and filter
  document.addEventListener('DOMContentLoaded', function() {
    filterBySpecialization();
    ['architecture-carousel','civil-carousel','mechanical-carousel','interior-carousel'].forEach(function(id){
      if(document.getElementById(id)) showEngineers(id, 0, 6);
    });
  });

  // Existing slider functions (keep as-is)
  function showEngineers(carouselId, startIdx, visibleCount) {
    const carousel = document.getElementById(carouselId);
    const cards = carousel.querySelectorAll('.engineer-card');
    cards.forEach((card, idx) => {
      card.style.display = (idx >= startIdx && idx < startIdx + visibleCount) ? 'flex' : 'none';
    });
    carousel.dataset.startIdx = startIdx;
  }
  function scrollEngineers(carouselId, direction) {
    const carousel = document.getElementById(carouselId);
    const cards = carousel.querySelectorAll('.engineer-card');
    const visibleCount = 3;
    let startIdx = parseInt(carousel.dataset.startIdx || '0');
    startIdx += direction * visibleCount;
    if (startIdx < 0) startIdx = 0;
    if (startIdx > cards.length - visibleCount) startIdx = Math.max(cards.length - visibleCount, 0);
    showEngineers(carouselId, startIdx, visibleCount);
  }
</script>

{% endblock %}